# 9️⃣-4️⃣ 자동 백업

> 🔵 핵심 요약 (한 줄)
> 
> 
> 자동 백업은 **사람을 제거한 백업**이며,
> 
> **스케줄 + 로그가 있어야 ‘운영’이라고 부를 수 있다.**
> 

---

## 1️⃣ cron

---

### 🧠 비유

> cron = 자동 알람 시계
> 
- 매일 아침 2시
- 매주 일요일
- 매 10분

사람 대신 “시간”이 명령을 실행

---

### 💻 기술적 정의

> cron = Linux/Unix 계열의 작업 스케줄러
> 

---

### 📄 기본 형식

```
분 시 일 월 요일  명령어

```

```bash
0 2 * * * /backup/db_backup.sh

```

➡ 매일 새벽 2시에 실행

---

### 🧠 중요 포인트

- 서버 재부팅 후에도 자동 실행
- 컨테이너 환경에서는 주의 필요 (K8s CronJob)

---

## 2️⃣ 스케줄링 전략

---

### 🧠 비유

> 보험을 매일 들 필요는 없다
> 

---

### 📊 백업 주기 예시

| 대상 | 주기 |
| --- | --- |
| DB Dump | 매일 |
| 파일 Full | 주 1회 |
| Incremental | 매일 |
| 로그 | 실시간/일 단위 |

---

### ⚖️ 설계 기준

- 데이터 중요도
- 변경 빈도
- 복구 허용 손실 (RPO)

---

### 🧠 실무 판단

> “1일치 데이터 날아가도 괜찮은가?”
> 

---

## 3️⃣ 백업 로그

---

### 🧠 비유

> “보험 가입 증명서”
> 

백업은 했다고 *믿는 것*이 아니라

👉 **로그로 확인하는 것**

---

### 💻 로그가 필요한 이유

- 성공/실패 확인
- 장애 원인 추적
- 자동 알림 연동

---

### 📄 예시 (쉘 스크립트)

```bash
mysqldump mydb > backup.sql \
  &&echo"SUCCESS $(date)" >> backup.log \
  ||echo"FAIL $(date)" >> backup.log

```

---

### 📄 로그 예

```
SUCCESS 2026-01-29 02:00
FAIL    2026-01-30 02:00

```

---

## 4️⃣ 자동 백업 전체 흐름

---

### 🧩 구조 다이어그램 (텍스트)

```
cron
  ↓
백업 스크립트 실행
  ↓
DBdump / 파일 백업
  ↓
외부 스토리지 저장
  ↓
로그 기록

```

---

### 🧠 여기서 로그가 없으면?

- 실패해도 모름 ❌
- 복구 시점에 발견 ❌

---

## 5️⃣ 네 프로젝트에 딱 맞게 연결하면

---

### 📦 Docker / MySQL 기준

| 항목 | 구성 |
| --- | --- |
| 실행 | cron |
| 백업 방식 | mysqldump |
| 저장소 | 볼륨 or 외부 디렉토리 |
| 로그 | backup.log |
| 확장 | Slack / Mail 알림 |

---

### 📄 프로젝트 문장으로 쓰면

> “DB는 cron 기반 자동 백업을 수행하며,
> 
> 
> 모든 백업 작업은 로그로 기록되어
> 
> 장애 발생 시 복구 가능성을 검증한다.”
> 

이 문장 **보고서·발표·면접 전부 먹힌다**.

---

## ⚠️ 실무에서 진짜 많이 터지는 사고

- cron 등록했는데 권한 오류 ❌
- 상대 경로 사용 ❌
- 로그 없음 ❌
- 컨테이너 재시작 시 cron 사라짐 ❌

---

## ✅ 9-4 최종 요약

- cron = 자동 실행
- 스케줄링 = 전략
- 로그 = 신뢰성
- 자동 백업은 운영의 최소 조건
