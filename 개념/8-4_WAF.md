# 8️⃣-4️⃣ WAF (Web Application Firewall)

> 🔵 핵심 요약 (큰 그림)
> 
> 
> WAF는 **웹 요청 내용을 검사해서
> “정상 사용자”와 “공격자”를 가려내는 보안 필터**다.
> Ingress 앞단에 두어 **애플리케이션에 도달하기 전에 공격을 차단**한다.
> 

---

## 1️⃣ WAF란 무엇인가?

### 🧠 비유

> 공항 보안 검색대
> 
- 비행기(웹 서버)는 안전하게 운항해야 함
- 탑승객(요청)은 모두 검사
- 위험 물품(공격 패턴)은 탑승 전에 차단

---

### 💻 기술적 정의

> WAF = 웹 애플리케이션 계층(L7)의 요청을 분석해
공격 패턴을 탐지·차단하는 방화벽
> 

---

### 🔍 기존 방화벽과 차이

| 구분 | 일반 방화벽 | WAF |
| --- | --- | --- |
| 기준 | IP / 포트 | 요청 내용 |
| 계층 | L3/L4 | L7 (HTTP) |
| 예 | 포트 차단 | SQL Injection 차단 |

---

## 2️⃣ WAF가 막는 대표적 공격

### 🧨 비유

> 겉보기엔 평범한 질문인데,
의도가 수상한 말들을 걸러내는 역할
> 

---

### 🚨 주요 공격 유형

- SQL Injection
- XSS (Cross Site Scripting)
- Command Injection
- Path Traversal
- 비정상적인 대량 요청 (봇)

---

### 📌 예시

```
?id=1 OR 1=1

```

➡️ **사람 눈엔 URL,
WAF 눈엔 “공격 시도”**

---

## 3️⃣ 왜 Ingress 앞단에 두는가?

### 🧠 비유

> 사무실 안에 들어와서 검사 ❌
건물 입구에서 검사 ⭕
> 

---

### 💻 구조적 이유

- Ingress = 외부 트래픽의 첫 관문
- 모든 요청이 반드시 통과

---

### 🔁 트래픽 흐름

```
외부 사용자
   ↓
WAF
   ↓
Ingress Controller
   ↓
Service
   ↓
Pod

```

---

### ✅ 이점

- 애플리케이션 부담 감소
- 공통 보안 정책 적용
- 공격 로그 중앙 관리

---

## 4️⃣ WAF가 없는 경우 vs 있는 경우

### ❌ 없는 경우

- 공격 요청이 앱까지 도달
- 코드 레벨 방어 필요
- 성능 저하

---

### ✅ 있는 경우

- 공격 요청 사전 차단
- 앱은 정상 요청만 처리
- 운영 안정성 ↑

---

## 5️⃣ 오픈소스 WAF 예시

### 🛡 ModSecurity

- 가장 널리 쓰이는 WAF 엔진
- Nginx / Apache 연동
- OWASP CRS 규칙 사용

---

### 🧠 프로젝트에서의 위치

- Nginx Ingress Controller + ModSecurity
- 또는 클라우드 WAF (AWS WAF)

---

## 🔗 네 프로젝트에 맞게 정리하면

| 요소 | 역할 |
| --- | --- |
| WAF | 공격 차단 |
| Ingress | 트래픽 관문 |
| Service/Pod | 실제 서비스 |

---

## ✅ 8-4 핵심 요약

- WAF는 웹 요청 내용을 검사하는 방화벽
- 포트가 아니라 “요청 내용”을 본다
- Ingress 앞단에 두는 것이 가장 효과적
- 앱을 공격으로부터 보호하는 1차 방어선
