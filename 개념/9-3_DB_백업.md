# 9️⃣-3️⃣ DB 백업 (확장)

> 🔵 핵심 요약 (큰 그림)
> 
> 
> DB 백업은 **파일이 아니라 ‘데이터 상태’를 저장하는 것**이며,
> 
> **복구를 전제로 설계하지 않으면 의미가 없다.**
> 

---

## 1️⃣ 논리 백업 vs 물리 백업

---

### 🧠 비유

> 논리 백업 = 레시피 보관
> 
> 
> **물리 백업 = 완성된 음식 통째로 냉동**
> 

---

### 💻 기술적 정의

| 구분 | 논리 백업 | 물리 백업 |
| --- | --- | --- |
| 대상 | SQL 문 | 데이터 파일 |
| 도구 | mysqldump | 스토리지 스냅샷 |
| 이식성 | 높음 | 낮음 |
| 복구 속도 | 느림 | 빠름 |

---

### 📌 언제 쓰나?

- 논리: 이관, 테스트, 소규모
- 물리: 대용량, 고가용성

---

## 2️⃣ Dump 개념

---

### 🧠 비유

> “데이터를 말로 설명한 설명서”
> 

---

### 💻 기술적 정의

> Dump = DB의 구조와 데이터를 SQL 형태로 추출한 결과
> 

---

### 📄 예시

```sql
CREATE TABLE users (...);
INSERT INTO usersVALUES (...);

```

---

### 🛠 MySQL 예시

```bash
mysqldump -u root -p mydb > mydb.sql

```

---

### 🧠 특징

- 사람이 읽을 수 있음
- 버전/환경 독립적
- 느리지만 안전

---

## 3️⃣ 복구 시나리오

---

### 🧠 비유

> 보험금 청구 시나리오
> 
- 사고 발생
- 보험 서류 제출
- 정상 상태 복구

---

### 💻 기본 복구 흐름 (논리 백업)

```
DB 장애 발생
   ↓
새 DB 인스턴스 생성
   ↓
Dump 파일 적용
   ↓
서비스 재연결

```

---

### 📄 복구 명령 예시

```bash
mysql -u root -p mydb < mydb.sql

```

---

## 4️⃣ 장애 상황별 복구 전략

---

### 🧨 실수로 데이터 삭제

- 최근 Dump 복원
- 일부 데이터 손실 감수

---

### 🔥 서버 완전 장애

- 새 서버
- DB 재설치
- Dump 복원

---

### 🧠 Kubernetes 환경에서

- DB Pod는 폐기
- PVC + Dump로 복구

---

## 🔗 네 프로젝트에 적용하면

| 구성 | 전략 |
| --- | --- |
| MySQL 컨테이너 | 논리 백업 |
| 백업 자동화 | cron + dump |
| 저장 위치 | 외부 볼륨 |
| 복구 | 새 컨테이너 + import |

---

## ⚠️ 실무에서 자주 터지는 사고

- 백업은 있었는데 복구 테스트 ❌
- Dump 파일 깨짐 ❌
- 비밀번호 백업 ❌

---

## ✅ 9-3 핵심 요약

- 논리 백업 = SQL
- 물리 백업 = 파일
- Dump는 DB 상태 설명서
- 백업은 복구까지 설계해야 의미 있음
